# ๐ ุชูุซูู APIs ุงููุตุงุฏูุฉ ูุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู

## ูุธุฑุฉ ุนุงูุฉ

ูููุฑ ูุธุงู ุงููุตุงุฏูุฉ ูู Sabq AI CMS ูุฌููุนุฉ ุดุงููุฉ ูู APIs ุงูุขููุฉ ูุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู ูุงูุฌูุณุงุช. ูุชุถูู ุงููุธุงู ุญูุงูุฉ ูุชูุฏูุฉ ูู ุงููุฌูุงุช ุงูุดุงุฆุนุฉ ูุฅุฏุงุฑุฉ ุขููุฉ ููุฌูุณุงุช ุจุงุณุชุฎุฏุงู JWT.

## ๐ก๏ธ ุงูุฃูุงู ูุงูุญูุงูุฉ

### ุงูููุฒุงุช ุงูุฃูููุฉ ุงููุทุจูุฉ:
- **ุชุดููุฑ ูููุงุช ุงููุฑูุฑ**: ุจุงุณุชุฎุฏุงู bcrypt ูุน salt rounds = 12
- **JWT ุขูู**: ูุน issuer ู audience verification
- **Rate Limiting**: ุญูุงูุฉ ูู ูุฌูุงุช Brute Force
- **ุชูุธูู ุงููุฏุฎูุงุช**: ุญูุงูุฉ ูู XSS attacks
- **Headers ุฃูููุฉ**: X-XSS-Protection, X-Frame-Options, X-Content-Type-Options
- **CORS**: ุฏุนู Cross-Origin Resource Sharing

### ููุงููู ูููุฉ ุงููุฑูุฑ:
- ุงูุญุฏ ุงูุฃุฏูู: 8 ุฃุญุฑู
- ูุฌุจ ุฃู ุชุญุชูู ุนูู: ุญุฑู ูุจูุฑุ ุญุฑู ุตุบูุฑุ ุฑููุ ุฑูุฒ ุฎุงุต

---

## ๐ ููุงุท ุงูููุงูุฉ (Endpoints)

### 1. ุชุณุฌูู ูุณุชุฎุฏู ุฌุฏูุฏ

**POST** `/api/auth/register`

#### ุงูุทูุจ (Request)
```json
{
  "name": "ุฃุญูุฏ ูุญูุฏ",
  "email": "ahmed@example.com",
  "password": "SecurePass123!"
}
```

#### ุงูุงุณุชุฌุงุจุฉ ุงููุงุฌุญุฉ (200)
```json
{
  "success": true,
  "user": {
    "id": "uuid-string",
    "email": "ahmed@example.com",
    "name": "ุฃุญูุฏ ูุญูุฏ",
    "role": "reader",
    "is_verified": false,
    "created_at": "2024-01-01T00:00:00.000Z"
  },
  "token": "jwt-token-string",
  "sessionId": "session-uuid"
}
```

#### ุฃุฎุทุงุก ูุญุชููุฉ
- **400**: ุจูุงูุงุช ุบูุฑ ุตุงูุญุฉ
- **400**: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู
- **400**: ูููุฉ ุงููุฑูุฑ ุถุนููุฉ
- **429**: ุชุฌุงูุฒ ุญุฏ ุงููุญุงููุงุช (3 ูุญุงููุงุช/ุณุงุนุฉ)

---

### 2. ุชุณุฌูู ุงูุฏุฎูู

**POST** `/api/auth/login`

#### ุงูุทูุจ (Request)
```json
{
  "email": "ahmed@example.com",
  "password": "SecurePass123!"
}
```

#### ุงูุงุณุชุฌุงุจุฉ ุงููุงุฌุญุฉ (200)
```json
{
  "success": true,
  "user": {
    "id": "uuid-string",
    "email": "ahmed@example.com",
    "name": "ุฃุญูุฏ ูุญูุฏ",
    "role": "reader",
    "is_verified": false,
    "last_login": "2024-01-01T00:00:00.000Z"
  },
  "token": "jwt-token-string",
  "sessionId": "session-uuid",
  "message": "ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ"
}
```

#### ุฃุฎุทุงุก ูุญุชููุฉ
- **400**: ุจูุงูุงุช ุบูุฑ ุตุงูุญุฉ
- **401**: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ
- **429**: ุชุฌุงูุฒ ุญุฏ ุงููุญุงููุงุช (5 ูุญุงููุงุช/15 ุฏูููุฉ)

---

### 3. ุชุณุฌูู ุงูุฎุฑูุฌ

**POST** `/api/auth/logout`

#### ุงูุทูุจ (Request)
```
Headers:
Authorization: Bearer jwt-token-string
```

#### ุงูุงุณุชุฌุงุจุฉ ุงููุงุฌุญุฉ (200)
```json
{
  "success": true,
  "message": "ุชู ุชุณุฌูู ุงูุฎุฑูุฌ ุจูุฌุงุญ",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

#### ุฃุฎุทุงุก ูุญุชููุฉ
- **401**: ุฑูุฒ ุงููุตุงุฏูุฉ ูุทููุจ
- **401**: ุฑูุฒ ุงููุตุงุฏูุฉ ุบูุฑ ุตุงูุญ
- **404**: ุงูุฌูุณุฉ ุบูุฑ ููุฌูุฏุฉ

---

### 4. ุชุณุฌูู ุงูุฎุฑูุฌ ูู ุฌููุน ุงูุฃุฌูุฒุฉ

**DELETE** `/api/auth/logout`

#### ุงูุทูุจ (Request)
```
Headers:
Authorization: Bearer jwt-token-string
```

#### ุงูุงุณุชุฌุงุจุฉ ุงููุงุฌุญุฉ (200)
```json
{
  "success": true,
  "message": "ุชู ุชุณุฌูู ุงูุฎุฑูุฌ ูู ุฌููุน ุงูุฃุฌูุฒุฉ ุจูุฌุงุญ",
  "sessionsDeleted": 3,
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

---

### 5. ุงูุญุตูู ุนูู ุจูุงูุงุช ุงููุณุชุฎุฏู ุงูุญุงูู

**GET** `/api/auth/me`

#### ุงูุทูุจ (Request)
```
Headers:
Authorization: Bearer jwt-token-string
```

#### ุงูุงุณุชุฌุงุจุฉ ุงููุงุฌุญุฉ (200)
```json
{
  "success": true,
  "user": {
    "id": "uuid-string",
    "email": "ahmed@example.com",
    "name": "ุฃุญูุฏ ูุญูุฏ",
    "role": "reader",
    "is_verified": false,
    "avatar_url": null,
    "bio": null,
    "last_login": "2024-01-01T00:00:00.000Z",
    "created_at": "2024-01-01T00:00:00.000Z",
    "updated_at": "2024-01-01T00:00:00.000Z"
  },
  "session": {
    "id": "session-uuid",
    "created_at": "2024-01-01T00:00:00.000Z",
    "ip_address": "192.168.1.1"
  }
}
```

---

### 6. ุชุญุฏูุซ ุงูููู ุงูุดุฎุตู

**PATCH** `/api/auth/me`

#### ุงูุทูุจ (Request)
```json
{
  "name": "ุฃุญูุฏ ูุญูุฏ ุงูุฌุฏูุฏ",
  "bio": "ูุทูุฑ ููุจ ูุชุฎุตุต ูู React ู Node.js",
  "avatar_url": "https://example.com/avatar.jpg"
}
```

#### ุงูุงุณุชุฌุงุจุฉ ุงููุงุฌุญุฉ (200)
```json
{
  "success": true,
  "message": "ุชู ุชุญุฏูุซ ุงูููู ุงูุดุฎุตู ุจูุฌุงุญ",
  "user": {
    "id": "uuid-string",
    "email": "ahmed@example.com",
    "name": "ุฃุญูุฏ ูุญูุฏ ุงูุฌุฏูุฏ",
    "role": "reader",
    "is_verified": false,
    "avatar_url": "https://example.com/avatar.jpg",
    "bio": "ูุทูุฑ ููุจ ูุชุฎุตุต ูู React ู Node.js",
    "last_login": "2024-01-01T00:00:00.000Z",
    "created_at": "2024-01-01T00:00:00.000Z",
    "updated_at": "2024-01-01T00:00:00.000Z"
  }
}
```

#### ูููุฏ ุงูุชุญุฏูุซ
- **name**: 2-100 ุญุฑู
- **bio**: ุญุฏ ุฃูุตู 500 ุญุฑู
- **avatar_url**: ุฑุงุจุท ุตุงูุญ

---

## ๐ ุงุณุชุฎุฏุงู JWT Token

### ูู ุงูุทูุจุงุช
```javascript
// ูู JavaScript
const response = await fetch('/api/auth/me', {
  headers: {
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json'
  }
});

// ูู cURL
curl -H "Authorization: Bearer jwt-token-string" \
     -H "Content-Type: application/json" \
     http://localhost:3000/api/auth/me
```

### ูุนูููุงุช ุงูู Token
- **ุงูุชูุงุก ุงูุตูุงุญูุฉ**: 7 ุฃูุงู
- **Issuer**: sabq-ai-cms
- **Audience**: sabq-ai-users
- **Algorithm**: HS256

---

## ๐ฆ ุฃููุงุฏ ุงูุญุงูุฉ (Status Codes)

| ุงูููุฏ | ุงููุตู |
|-------|--------|
| 200 | ูุฌุญ ุงูุทูุจ |
| 400 | ุจูุงูุงุช ุบูุฑ ุตุงูุญุฉ |
| 401 | ุบูุฑ ูุตุฑุญ |
| 403 | ููููุน |
| 404 | ุบูุฑ ููุฌูุฏ |
| 423 | ุงูุญุณุงุจ ูููู |
| 429 | ุชุฌุงูุฒ ุงูุญุฏ ุงููุณููุญ |
| 500 | ุฎุทุฃ ูู ุงูุฎุงุฏู |

---

## ๐๏ธ ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู ูุงูู ูุชุณุฌูู ุงูุฏุฎูู ูุฅุฏุงุฑุฉ ุงูุฌูุณุฉ

```javascript
// ุชุณุฌูู ุงูุฏุฎูู
async function login(email, password) {
  try {
    const response = await fetch('/api/auth/login', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ email, password })
    });

    const data = await response.json();
    
    if (data.success) {
      // ุญูุธ ุงูุชููู
      localStorage.setItem('token', data.token);
      localStorage.setItem('user', JSON.stringify(data.user));
      return data;
    } else {
      throw new Error(data.error);
    }
  } catch (error) {
    console.error('ุฎุทุฃ ูู ุชุณุฌูู ุงูุฏุฎูู:', error);
    throw error;
  }
}

// ุงูุญุตูู ุนูู ุจูุงูุงุช ุงููุณุชุฎุฏู
async function getCurrentUser() {
  const token = localStorage.getItem('token');
  
  if (!token) {
    throw new Error('ูู ูุชู ุชุณุฌูู ุงูุฏุฎูู');
  }

  try {
    const response = await fetch('/api/auth/me', {
      headers: {
        'Authorization': `Bearer ${token}`,
        'Content-Type': 'application/json'
      }
    });

    const data = await response.json();
    
    if (data.success) {
      return data.user;
    } else {
      throw new Error(data.error);
    }
  } catch (error) {
    console.error('ุฎุทุฃ ูู ุงูุญุตูู ุนูู ุจูุงูุงุช ุงููุณุชุฎุฏู:', error);
    throw error;
  }
}

// ุชุณุฌูู ุงูุฎุฑูุฌ
async function logout() {
  const token = localStorage.getItem('token');
  
  if (!token) {
    return;
  }

  try {
    await fetch('/api/auth/logout', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${token}`,
        'Content-Type': 'application/json'
      }
    });

    // ุฅุฒุงูุฉ ุงูุจูุงูุงุช ุงููุญููุฉ
    localStorage.removeItem('token');
    localStorage.removeItem('user');
    
    // ุฅุนุงุฏุฉ ุชูุฌูู ููุตูุญุฉ ุงูุฑุฆูุณูุฉ
    window.location.href = '/';
  } catch (error) {
    console.error('ุฎุทุฃ ูู ุชุณุฌูู ุงูุฎุฑูุฌ:', error);
  }
}
```

---

## ๐ ุฃูุถู ุงูููุงุฑุณุงุช ุงูุฃูููุฉ

### ูููุทูุฑูู
1. **ูุง ุชุฎุฒู ูููุงุช ุงููุฑูุฑ ูู ุงููุตูุต ุงูุนุงุฏูุฉ**
2. **ุงุณุชุฎุฏู HTTPS ูู ุงูุฅูุชุงุฌ**
3. **ูู ุจุชุญุฏูุซ ุงูุชููู ุจุงูุชุธุงู**
4. **ุงุญุฐู ุงูุฌูุณุงุช ุงูููุชููุฉ ุงูุตูุงุญูุฉ**
5. **ุฑุงูุจ ุงููุญุงููุงุช ุงููุดุจููุฉ**

### ูููุณุชุฎุฏููู
1. **ุงุณุชุฎุฏู ูููุงุช ูุฑูุฑ ูููุฉ**
2. **ูุง ุชุดุงุฑู ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู**
3. **ุณุฌู ุงูุฎุฑูุฌ ูู ุงูุฃุฌูุฒุฉ ุงูุนุงูุฉ**
4. **ุฑุงูุจ ูุดุงุท ุญุณุงุจู**

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดุงูู ุดุงุฆุนุฉ ูุญููููุง

#### 1. "ุฑูุฒ ุงููุตุงุฏูุฉ ุบูุฑ ุตุงูุญ"
- **ุงูุณุจุจ**: ุงูุชููู ููุชูู ุงูุตูุงุญูุฉ ุฃู ุชุงูู
- **ุงูุญู**: ุชุณุฌูู ุงูุฏุฎูู ูุฑุฉ ุฃุฎุฑู

#### 2. "ุชุฌุงูุฒ ุญุฏ ุงููุญุงููุงุช"
- **ุงูุณุจุจ**: ูุญุงููุงุช ุชุณุฌูู ุฏุฎูู ูุซูุฑุฉ
- **ุงูุญู**: ุงูุชุธุงุฑ 15 ุฏูููุฉ ูุจู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู

#### 3. "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู"
- **ุงูุณุจุจ**: ููุฌุฏ ุญุณุงุจ ุจููุณ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- **ุงูุญู**: ุงุณุชุฎุฏุงู ุจุฑูุฏ ุฅููุชุฑููู ุขุฎุฑ ุฃู ุชุณุฌูู ุงูุฏุฎูู

#### 4. "ูููุฉ ุงููุฑูุฑ ุถุนููุฉ"
- **ุงูุณุจุจ**: ูููุฉ ุงููุฑูุฑ ูุง ุชูุจู ุงููุชุทูุจุงุช
- **ุงูุญู**: ุงุณุชุฎุฏุงู ูููุฉ ูุฑูุฑ ุชุญุชูู ุนูู ุฃุญุฑู ูุจูุฑุฉ ูุตุบูุฑุฉ ูุฃุฑูุงู ูุฑููุฒ

---

## ๐ ูุฑุงูุจุฉ ุงูุฃุฏุงุก

### ูุคุดุฑุงุช ูููุฉ
- **ููุช ุงูุงุณุชุฌุงุจุฉ**: < 200ms ููุทูุจุงุช ุงูุนุงุฏูุฉ
- **ูุนุฏู ุงููุฌุงุญ**: > 99%
- **ุงูุฌูุณุงุช ุงููุดุทุฉ**: ูุฑุงูุจุฉ ูุณุชูุฑุฉ
- **ุงููุญุงููุงุช ุงููุงุดูุฉ**: ุชูุจููุงุช ุชููุงุฆูุฉ

### ุชุณุฌูู ุงูุฃุญุฏุงุซ
- ุฌููุน ูุญุงููุงุช ุชุณุฌูู ุงูุฏุฎูู
- ุชุณุฌูู ุงูุฎุฑูุฌ
- ุชุญุฏูุซ ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ
- ุงูุฃุฎุทุงุก ูุงููุญุงููุงุช ุงููุดุจููุฉ

---

## ๐ ุงูุชุญุฏูุซุงุช ุงููุณุชูุจููุฉ

### ุงูููุฒุงุช ุงููุฎุทุท ููุง
- [ ] ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ (2FA)
- [ ] ุชุณุฌูู ุงูุฏุฎูู ุจุงูุจุตูุฉ
- [ ] ุชูุงูู OAuth (Google, Apple)
- [ ] ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช ุงููุชูุฏูุฉ
- [ ] ุชุญูููุงุช ุงูุฃูุงู

---

**ุขุฎุฑ ุชุญุฏูุซ**: ููุงูุฑ 2024  
**ุงููุทูุฑ**: ุนูู ุงูุญุงุฒูู  
**ุงูุฅุตุฏุงุฑ**: 2.1.0 