# ๐ ุฏููู ูุธุงู ุงูุชูุฌูู ุงูุฐูู ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู

## ๐ **ูุธุฑุฉ ุนุงูุฉ**

ุชู ุชุทููุฑ ูุธุงู ุชูุฌูู ุฐูู ูููุฌู ุงููุณุชุฎุฏููู ุฅูู ุงูุตูุญุฉ ุงูููุงุณุจุฉ ุจูุงุกู ุนูู:
- ููุน ุงููุณุชุฎุฏู ูุตูุงุญูุงุชู
- ุงูุตูุญุฉ ุงูุชู ุญุงูู ุงููุตูู ุฅูููุง ุฃุตูุงู
- ุญุงูุฉ ุงููุณุชุฎุฏู (ุฌุฏูุฏ/ูุฏูู)

## ๐ฏ **ููู ูุนูู ุงููุธุงู**

### 1๏ธโฃ **ูููุฏูุฑูู ูุงููุญุฑุฑูู**
```
ุงููุฏูุฑ/ุงููุญุฑุฑ โ `/dashboard` (ููุญุฉ ุงูุชุญูู)
```

### 2๏ธโฃ **ูููุณุชุฎุฏููู ุงูุฌุฏุฏ**
```
ูุณุชุฎุฏู ุฌุฏูุฏ โ `/welcome/preferences` (ุงุฎุชูุงุฑ ุงูุงูุชูุงูุงุช)
```

### 3๏ธโฃ **ูููุณุชุฎุฏููู ุงูุนุงุฏููู**
```
ูุณุชุฎุฏู ุนุงุฏู โ `/` (ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ุงููุฎุตุตุฉ)
```

### 4๏ธโฃ **ูุน ูุฌูุฏ callbackUrl**
```
ุฃู ูุณุชุฎุฏู + callbackUrl โ ุงูุตูุญุฉ ุงููุทููุจุฉ ูุจุงุดุฑุฉ
```

---

## ๐งช **ุญุณุงุจุงุช ุงูุงุฎุชุจุงุฑ**

### **ูุฏูุฑูู**
- `admin@test.com` / `123456` โ ููุญุฉ ุงูุชุญูู
- `ali@alhazmi.org` / `123456` โ ููุญุฉ ุงูุชุญูู

### **ูุญุฑุฑูู**
- `editor@test.com` / `123456` โ ููุญุฉ ุงูุชุญูู

### **ูุณุชุฎุฏููู ุนุงุฏููู**
- `user@test.com` / `123456` โ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
- `test@test.com` / `123456` โ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ

---

## ๐ **ุงุณุชุฎุฏุงู callbackUrl**

### **ุงูุทุฑููุฉ ุงูุฃููู: ุนุจุฑ Query Parameter**
```
http://localhost:3003/login?callbackUrl=/article/123
http://localhost:3003/login?redirect=/dashboard/news
http://localhost:3003/login?returnTo=/welcome/preferences
```

### **ุงูุทุฑููุฉ ุงูุซุงููุฉ: ูู ุตูุญุฉ ูุญููุฉ**
ุนูุฏูุง ูุญุงูู ุงููุณุชุฎุฏู ุงููุตูู ูุตูุญุฉ ูุญููุฉ ุจุฏูู ุชุณุฌูู ุฏุฎูู:
```javascript
// ูู middleware ุฃู ุตูุญุฉ ูุญููุฉ
router.push(`/login?callbackUrl=${encodeURIComponent(currentPath)}`);
```

### **ุงูุทุฑููุฉ ุงูุซุงูุซุฉ: ุจุฑูุฌูุงู**
```javascript
// ูู ุฃู ููุงู ูู ุงูููุฏ
const redirectTo = '/dashboard/article/create';
window.location.href = `/login?callbackUrl=${encodeURIComponent(redirectTo)}`;
```

---

## ๐ **ูููู ุงููููุงุช ุงูููุญุฏุซุฉ**

```
app/
โโโ login/
โ   โโโ page.tsx                    # ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู ูุน ุชูุฌูู ุฐูู
โโโ welcome/
โ   โโโ preferences/
โ       โโโ page.tsx                # ุตูุญุฉ ุงุฎุชูุงุฑ ุงูุงูุชูุงูุงุช
โโโ api/
    โโโ auth/
        โโโ login/
            โโโ route.ts            # API endpoint ูุน ุฏุนู ุฃุฏูุงุฑ ูุชุนุฏุฏุฉ
```

---

## โ๏ธ **ุงูุฅุนุฏุงุฏุงุช ูุงููุชุบูุฑุงุช**

### **ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุงููุทููุจุฉ**
```env
NEXTAUTH_URL=http://localhost:3003
NEXT_PUBLIC_APP_URL=http://localhost:3003
```

### **ุฃุฏูุงุฑ ุงููุณุชุฎุฏููู ุงููุฏุนููุฉ**
- `admin` - ูุฏูุฑ ุงููุธุงู
- `editor` - ูุญุฑุฑ
- `user` - ูุณุชุฎุฏู ุนุงุฏู (ุงูุชุฑุงุถู)

---

## ๐๏ธ **ุงูุชุฎุตูุต ูุงูุชุทููุฑ**

### **ุฅุถุงูุฉ ุฏูุฑ ุฌุฏูุฏ**
1. ุญุฏุซ API endpoint ูู `app/api/auth/login/route.ts`
2. ุฃุถู ููุทู ุงูุชูุฌูู ูู `app/login/page.tsx`

### **ุฅุถุงูุฉ ุตูุญุฉ ุชุฑุญูุจ ูุฎุตุตุฉ**
```javascript
// ูู app/login/page.tsx
} else if (data.user.needs_onboarding) {
  router.push('/welcome/onboarding');
} else if (data.user.role === 'newRole') {
  router.push('/custom-page');
```

### **ุฅุถุงูุฉ ูุณุชุฎุฏู ุงุฎุชุจุงุฑ ุฌุฏูุฏ**
```javascript
// ูู app/api/auth/login/route.ts
const testUsers = {
  'newuser@test.com': {
    id: 'test-newuser',
    name: 'ูุณุชุฎุฏู ุฌุฏูุฏ',
    email: 'newuser@test.com',
    role: 'newrole',
    is_admin: false
  },
  // ... ุจุงูู ุงููุณุชุฎุฏููู
};
```

---

## ๐ **ุงูุฃูุงู ูุงูุญูุงูุฉ**

### **ุชูุธูู ุงูุฑูุงุจุท**
- ููุท ุงูุฑูุงุจุท ุงูุชู ุชุจุฏุฃ ุจู `/` ูุณููุญุฉ
- ููุน ุงูุชูุฌูู ูู `/login` ูุฑุฉ ุฃุฎุฑู
- ุชุดููุฑ ููู ุชุดููุฑ ุงููุนุงููุงุช ุงูุญุณุงุณุฉ

### **ุงูุชุญูู ูู ุงูุตูุงุญูุงุช**
```javascript
const isAdmin = user.is_admin === true || 
               user.role === 'admin' || 
               user.role === 'editor';
```

---

## ๐ **ูุฑุงูุจุฉ ููุชุงุจุนุฉ**

### **ููุฌุฒ ุชุณุฌูู ุงูุฏุฎูู**
```javascript
console.log('ุชูุฌูู ูุณุชุฎุฏู ุนุงุฏู ุฅูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ');
console.log('ุชุณุฌูู ุฏุฎูู ูุงุฌุญ ูููุณุชุฎุฏู:', user.email, 'ุฏูุฑ:', user.role);
```

### **ุฅุญุตุงุฆูุงุช ุงูุชูุฌูู**
- ุนุฏุฏ ุงููุณุชุฎุฏููู ุงูููุฌููู ููู ุตูุญุฉ
- ูุนุฏู ูุฌุงุญ ุงูุชูุฌูู
- ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ

---

## ๐ **ุฎุทูุงุช ุงูุชุดุบูู**

1. **ุชุดุบูู ุงูุณูุฑูุฑ**
```bash
cd /Users/alialhazmi/Projects/sabq-ai-cms-new
npm run dev
```

2. **ูุชุญ ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู**
```
http://localhost:3003/login
```

3. **ุงุฎุชุจุงุฑ ุงูุชูุฌูู**
```
# ูุณุชุฎุฏู ุนุงุฏู
http://localhost:3003/login โ ุฏุฎูู ุจู user@test.com โ /

# ูุฏูุฑ
http://localhost:3003/login โ ุฏุฎูู ุจู admin@test.com โ /dashboard

# ูุน callbackUrl
http://localhost:3003/login?callbackUrl=/dashboard/news โ ุฏุฎูู โ /dashboard/news
```

---

## ๐ **ุงููุชุงุฆุฌ ุงููุชููุนุฉ**

โ **ุงููุฏูุฑูู ูุฐูุจูู ูุจุงุดุฑุฉ ูููุญุฉ ุงูุชุญูู**
โ **ุงููุณุชุฎุฏููู ุงูุนุงุฏููู ูุฐูุจูู ููุตูุญุฉ ุงูุฑุฆูุณูุฉ**
โ **ุงููุณุชุฎุฏููู ุงูุฌุฏุฏ ูุญุฏุฏูู ุงูุชูุงูุงุชูู ุฃููุงู**
โ **ุฏุนู ูุงูู ูู callbackUrl ูู ุฃู ูุตุฏุฑ**
โ **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ ููุฎุตุตุฉ**

---

*ุชู ุงูุชุทููุฑ ุจูุงุณุทุฉ ูุฑูู ุณุจู ุงูุฐูู ๐ค* 