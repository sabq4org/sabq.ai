# ๐ง ุฏููู ุฅุตูุงุญ ูุดุงูู ุงููุตุงุฏูุฉ ุนูู DigitalOcean

## ๐ ุงููุดุงูู ุงูููุชุดูุฉ

### โ ุงูุฃุฎุทุงุก ุงูุญุงููุฉ:
- `401 Unauthorized` ุนูู `/api/auth/me`
- `500 Internal Server Error` ุนูู `/api/auth/login`
- ูุดุงูู ูู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
- ูุดุงูู ูู ุฅุนุฏุงุฏุงุช JWT

## ๐๏ธ ุงูุญููู ุงููุทุจูุฉ

### 1๏ธโฃ ุชุญุณูู API Routes ูููุตุงุฏูุฉ

#### โ `/api/auth/login` - ุชู ุชุญุณููู:
- ุฅุถุงูุฉ ูุญุต ุดุงูู ููุชุบูุฑุงุช ุงูุจูุฆุฉ
- ูุนุงูุฌุฉ ุฃูุถู ูุฃุฎุทุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชุญุณูู ุฅุฏุงุฑุฉ ุงุชุตุงูุงุช Prisma
- ุฅุถุงูุฉ ุฑููุฒ ุฃุฎุทุงุก ูุงุถุญุฉ
- ุชุญุณูู ุฅุนุฏุงุฏุงุช ุงูููููุฒ

#### โ `/api/auth/me` - ุชู ุชุญุณููู:
- ูุตู ุงุณุชุนูุงูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุชุฌูุจ ุฃุฎุทุงุก ุงูุนูุงูุงุช
- ูุนุงูุฌุฉ ุฃูุถู ููุฃุฎุทุงุก
- ุฅุถุงูุฉ fallback ููุจูุงูุงุช ุงูููููุฏุฉ
- ุชุญุณูู ุฅุฏุงุฑุฉ ุงูุงุชุตุงูุงุช

### 2๏ธโฃ ุณูุฑูุจุช ุงูุฅุตูุงุญ ุงูุชููุงุฆู

ุชู ุฅูุดุงุก `scripts/fix-digitalocean-auth.js` ุงูุฐู ูููู ุจู:
- ูุญุต ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุงููุทููุจุฉ
- ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุงูุชุญูู ูู ูุฌูุฏ ูุณุชุฎุฏู admin ูุฅูุดุงุคู ุฅุฐุง ูุฒู ุงูุฃูุฑ
- ุงุฎุชุจุงุฑ ุนูู JWT
- ุนุฑุถ ุชูุฑูุฑ ุดุงูู ุนู ุญุงูุฉ ุงููุธุงู

## ๐ ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุงููุทููุจุฉ

ูุฌุจ ุฅุถุงูุฉ ูุฐู ุงููุชุบูุฑุงุช ูู **DigitalOcean App Platform**:

```bash
DATABASE_URL=[ุงุณุชุฎุฏู ุงููููุฉ ูู ููู PRIVATE_ENV_VALUES.txt]
JWT_SECRET=82ec93a86232fee07dcee0e3669bb4191953cb42d6ea6847808431d92eda6a1f
NEXTAUTH_SECRET=3fba94fd1803f7e72aebf109e4dcb3039c2fb094d3d94b9301e94feec00374c5
NODE_ENV=production
```

> **โ๏ธ ููู:** ุงุณุชุฎุฏู ุงูููู ุงููุนููุฉ ูู ููู `PRIVATE_ENV_VALUES.txt` ุงูููุฌูุฏ ูู ุงููุดุฑูุน.

## ๐ ุฎุทูุงุช ุงูุฅุตูุงุญ ุนูู DigitalOcean

### ุงูุฎุทูุฉ 1: ุฅุถุงูุฉ ูุชุบูุฑุงุช ุงูุจูุฆุฉ
1. ุงุฐูุจ ุฅูู **DigitalOcean App Platform**
2. ุงุฎุชุฑ ุชุทุจูู `sabq-ai-cms`
3. ุงุฐูุจ ุฅูู **Settings** โ **Environment Variables**
4. ุฃุถู ุงููุชุบูุฑุงุช ุงููุฐููุฑุฉ ุฃุนูุงู

### ุงูุฎุทูุฉ 2: ุฅุนุงุฏุฉ ุงููุดุฑ
1. ูู **Deployments** ุงุถุบุท ุนูู **Create Deployment**
2. ุฃู ุงุณุชุฎุฏู **Force Rebuild** ุฅุฐุง ูู ุชูู ููุงู ุชุบููุฑุงุช ุฌุฏูุฏุฉ

### ุงูุฎุทูุฉ 3: ุงูุชุญูู ูู ุงูุญุงูุฉ
1. ุงูุชุธุฑ ุญุชู ููุชูู ุงููุดุฑ
2. ุงุฐูุจ ุฅูู ุฑุงุจุท ุงูุชุทุจูู
3. ุฌุฑุจ ุชุณุฌูู ุงูุฏุฎูู ุจุงุณุชุฎุฏุงู:
   - **ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:** `admin@sabq.org`
   - **ูููุฉ ุงููุฑูุฑ:** `admin123456`

### ุงูุฎุทูุฉ 4: ูุญุต ุงูุณุฌูุงุช (ุฅุฐุง ุงุณุชูุฑุช ุงููุดุงูู)
1. ูู **Runtime Logs** ุงุจุญุซ ุนู ุฑุณุงุฆู ุชุจุฏุฃ ุจู `[AUTH]`
2. ุชุญูู ูู ูุฌูุฏ ุฃุฎุทุงุก ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
3. ุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุฑุณุงุฆู ุฎุทุฃ ุญูู `JWT_SECRET`

## ๐ ุชุดุฎูุต ุงููุดุงูู

### ุฅุฐุง ูุงู ุงูุฎุทุฃ 503 (Service Unavailable):
- ุชุญูู ูู `DATABASE_URL` ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ
- ุชุฃูุฏ ูู ุตุญุฉ ุฑุงุจุท ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชุญูู ูู ุฃู PlanetScale database ูุดุท

### ุฅุฐุง ูุงู ุงูุฎุทุฃ 500 (Internal Server Error):
- ุชุญูู ูู `JWT_SECRET` ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ
- ุชุฃูุฏ ูู ุนุฏู ุงุณุชุฎุฏุงู ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ
- ุฑุงุฌุน ุณุฌูุงุช ุงูุชุทุจูู ูููุฒูุฏ ูู ุงูุชูุงุตูู

### ุฅุฐุง ูุงู ุงูุฎุทุฃ 401 (Unauthorized):
- ุชุฃูุฏ ูู ูุฌูุฏ ูุณุชุฎุฏู admin ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชุญูู ูู ุชุดููุฑ ูููุฉ ุงููุฑูุฑ
- ุฌุฑุจ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ูุฑูุฑ admin

## ๐งช ุงุฎุชุจุงุฑ ุงููุธุงู ูุญููุงู

```bash
# ุชุดุบูู ุณูุฑูุจุช ุงูุฅุตูุงุญ
node scripts/fix-digitalocean-auth.js

# ุชุดุบูู ุงูุฎุงุฏู ุงููุญูู
npm run dev

# ุงุฎุชุจุงุฑ ุชุณุฌูู ุงูุฏุฎูู
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@sabq.org","password":"admin123456"}'
```

## ๐ ูุนูููุงุช ุงููุณุชุฎุฏู ุงูุงูุชุฑุงุถู

```json
{
  "id": "230a1f62-ad7c-453a-b7d3-4524be3c73d5",
  "email": "admin@sabq.org",
  "name": "ุนูู ุนุจุฏู",
  "role": "admin",
  "isAdmin": true,
  "isVerified": true
}
```

## ๐จ ูุตุงุฆุญ ูููุฉ

1. **ูุง ุชุดุงุฑู ูุชุบูุฑุงุช ุงูุจูุฆุฉ**: ุงุญุชูุธ ุจูุง ุขููุฉ
2. **ุฑุงูุจ ุงูุณุฌูุงุช**: ุชุญูู ูู ุณุฌูุงุช ุงูุชุทุจูู ุจุงูุชุธุงู
3. **ุงุฎุชุจุฑ ูุญููุงู ุฃููุงู**: ุชุฃูุฏ ูู ุนูู ูู ุดูุก ูุญููุงู ูุจู ุงููุดุฑ
4. **ุงุญุชูุธ ุจูุณุฎุฉ ุงุญุชูุงุทูุฉ**: ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุจู ุฅุฌุฑุงุก ุชุบููุฑุงุช ูุจูุฑุฉ

## ๐ ุฅุฐุง ุงุณุชูุฑุช ุงููุดุงูู

1. ุชุญูู ูู ุญุงูุฉ PlanetScale database
2. ุฑุงุฌุน ุณุฌูุงุช DigitalOcean ููุฃุฎุทุงุก ุงูุชูุตูููุฉ
3. ุฌุฑุจ ุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุชุทุจูู ูู ุงูุตูุฑ ุฅุฐุง ูุฒู ุงูุฃูุฑ

---

**ุชุงุฑูุฎ ุขุฎุฑ ุชุญุฏูุซ:** ููุงูุฑ 2025  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุชุทุจูู 